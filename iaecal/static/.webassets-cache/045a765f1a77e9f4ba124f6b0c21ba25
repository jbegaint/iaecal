V(function(){'use strict';var app=angular.module('IAECalApp',['angularSpinner']);app.controller('IAECalController',['$scope','$http','$timeout','usSpinnerService',function($scope,$http,$timeout,usSpinnerService){var csrftoken=angular.element('meta[name=csrf-token]').attr('content');$http.defaults.headers.post['X-CSRFToken']=csrftoken;$scope.errors={};$scope.showUrl=false;$scope.submitForm=function(){if($scope.showUrl)\u000areturn; $scope.serverData={};usSpinnerService.spin('spinner-form');$http.post('/toto',{'username':$scope.username,'password':$scope.password,}).success(function(data){angular.forEach(data,function(value,field){$scope.serverData[field]=value;});$scope.showUrl=true;}).error(function(data){angular.forEach(data.errors,function(errors,field){$scope.form[field].$setValidity('server',false);$scope.errors[field]=errors.join(', ');});}).finally(function(){$timeout(function(){usSpinnerService.stop('spinner-form');},100);});};}]);app.directive('serverError',function(){return{restrict:'A',require:'?ngModel',link:function(scope,element,attrs,ctrl){element.on('change',function(){scope.$apply(function(){ctrl.$setValidity('server',true);});});},};});}());
p1
.